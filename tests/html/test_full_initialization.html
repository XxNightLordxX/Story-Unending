<!DOCTYPE html>
<html>
<head>
    <title>Test Full Initialization</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        .info { background: #d1ecf1; border-color: #bee5eb; }
        #debugResults { position: fixed; top: 10px; right: 10px; width: 400px; max-height: 80vh; overflow-y: auto; background: white; border: 2px solid #333; padding: 10px; z-index: 9999; }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <div id="debugResults"></div>
    
    <!-- Copy the main content structure from index.html -->
    <main class="main-content" id="mainContent" role="main" aria-label="Story content">
        <div id="storyContainer"></div>
    </main>
    
    <!-- Load all the scripts in the same order as index.html -->
    <script src="backstory-engine.js"></script>
    <script src="story-engine.js"></script>
    <script src="js/utils/security.js"></script>
    <script src="js/utils/safe-html.js"></script>
    <script src="js/utils/storage.js"></script>
    <script src="js/utils/prompt-modal.js"></script>
    <script src="js/utils/helpers.js"></script>
    <script src="js/utils/formatters.js"></script>
    <script src="js/utils/ui-helpers.js"></script>
    <script src="js/modules/app-state.js"></script>
    <script src="js/modules/story-timeline.js"></script>
    <script src="js/modules/auth.js"></script>
    <script src="js/modules/navigation.js"></script>
    <script src="js/modules/misc.js"></script>
    <script src="js/modules/generation.js"></script>
    <script src="js/modules/initialization.js"></script>
    <script src="js/ui/sidebar.js"></script>
    <script src="js/ui/stats.js"></script>
    <script src="js/ui/dropdown.js"></script>
    <script src="js/ui/text-size.js"></script>
    <script src="js/ui/modals.js"></script>
    <script src="js/ui/notifications.js"></script>
    <script src="js/ui/keyboard-shortcuts.js"></script>
    
    <script>
        const debugResults = document.getElementById('debugResults');
        
        function addDebugResult(message, type) {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.textContent = message;
            debugResults.appendChild(div);
            console.log(`[DEBUG] ${message}`);
        }
        
        // Override console.log to capture output
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            if (args.length > 0) {
                const message = args.map(arg => typeof arg === 'object' ? JSON.stringify(arg) : String(arg)).join(' ');
                addDebugResult(message, 'info');
            }
        };
        
        // Override console.error to capture errors
        const originalError = console.error;
        console.error = function(...args) {
            originalError.apply(console, args);
            if (args.length > 0) {
                const message = args.map(arg => typeof arg === 'object' ? JSON.stringify(arg) : String(arg)).join(' ');
                addDebugResult(`ERROR: ${message}`, 'error');
            }
        };
        
        addDebugResult('=== Test Full Initialization Started ===', 'info');
        
        // Check if AppState is available after scripts load
        setTimeout(() => {
            if (typeof AppState !== 'undefined') {
                addDebugResult(`✓ AppState is defined`, 'success');
                addDebugResult(`  totalGenerated: ${AppState.totalGenerated}`, 'info');
                addDebugResult(`  chapters.length: ${AppState.chapters.length}`, 'info');
                addDebugResult(`  currentChapter: ${AppState.currentChapter}`, 'info');
                
                if (AppState.chapters.length > 0) {
                    addDebugResult(`  First chapter: ${AppState.chapters[0].title}`, 'info');
                }
            } else {
                addDebugResult(`✗ AppState is NOT defined`, 'error');
            }
            
            // Check if showChapter is available
            if (typeof showChapter !== 'undefined') {
                addDebugResult(`✓ showChapter function is defined`, 'success');
            } else {
                addDebugResult(`✗ showChapter function is NOT defined`, 'error');
            }
            
            // Check storyContainer
            const storyContainer = document.getElementById('storyContainer');
            if (storyContainer) {
                addDebugResult(`✓ storyContainer element exists`, 'success');
                addDebugResult(`  InnerHTML length: ${storyContainer.innerHTML.length}`, 'info');
                if (storyContainer.innerHTML.length > 0) {
                    addDebugResult(`  Content preview: ${storyContainer.innerHTML.substring(0, 200)}...`, 'info');
                } else {
                    addDebugResult(`  storyContainer is EMPTY!`, 'error');
                }
            } else {
                addDebugResult(`✗ storyContainer element NOT found`, 'error');
            }
        }, 2000);
    </script>
</body>
</html>